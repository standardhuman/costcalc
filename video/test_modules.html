<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Module Test</title>
</head>
<body>
    <h1>Testing New JavaScript Modules</h1>
    <div id="results"></div>

    <!-- Load new modules -->
    <script src="/static/js/utils/formatters.js"></script>
    <script src="/static/js/utils/validation.js"></script>
    <script src="/static/js/utils/dragDrop.js"></script>
    <script src="/static/js/services/apiClient.js"></script>
    <script src="/static/js/services/alertService.js"></script>
    <script src="/static/js/services/uploadService.js"></script>

    <script>
        const results = document.getElementById('results');
        const tests = [];

        // Test formatters
        try {
            const formattedBytes = formatters.formatBytes(1024 * 1024);
            tests.push({ name: 'formatters.formatBytes', pass: formattedBytes === '1 MB', result: formattedBytes });

            const formattedDate = formatters.formatDateForInput(new Date('2025-01-15'));
            tests.push({ name: 'formatters.formatDateForInput', pass: formattedDate === '2025-01-15', result: formattedDate });
        } catch (e) {
            tests.push({ name: 'formatters', pass: false, error: e.message });
        }

        // Test validation
        try {
            const boatValidation = validation.validateBoatName('Test Boat');
            tests.push({ name: 'validation.validateBoatName', pass: boatValidation.valid === true, result: boatValidation });

            const dateValidation = validation.validateDate('2025-01-15');
            tests.push({ name: 'validation.validateDate', pass: dateValidation.valid === true, result: dateValidation });
        } catch (e) {
            tests.push({ name: 'validation', pass: false, error: e.message });
        }

        // Test dragDrop
        try {
            const hasFunctions = typeof dragDrop.initializeFileDropzone === 'function'
                && typeof dragDrop.preventDefaultDragDrop === 'function';
            tests.push({ name: 'dragDrop functions', pass: hasFunctions, result: 'Functions exist' });
        } catch (e) {
            tests.push({ name: 'dragDrop', pass: false, error: e.message });
        }

        // Test apiClient
        try {
            const hasClient = typeof apiClient !== 'undefined' && typeof apiClient.get === 'function';
            tests.push({ name: 'apiClient instance', pass: hasClient, result: 'APIClient exists' });
        } catch (e) {
            tests.push({ name: 'apiClient', pass: false, error: e.message });
        }

        // Test alertService
        try {
            const hasService = typeof alertService !== 'undefined' && typeof alertService.show === 'function';
            tests.push({ name: 'alertService instance', pass: hasService, result: 'AlertService exists' });
        } catch (e) {
            tests.push({ name: 'alertService', pass: false, error: e.message });
        }

        // Test uploadService
        try {
            const hasUploadService = typeof uploadService !== 'undefined' && typeof uploadService.startPolling === 'function';
            tests.push({ name: 'uploadService instance', pass: hasUploadService, result: 'UploadService exists' });
        } catch (e) {
            tests.push({ name: 'uploadService', pass: false, error: e.message });
        }

        // Display results
        let html = '<h2>Test Results</h2>';
        let passed = 0;
        let failed = 0;

        tests.forEach(test => {
            const status = test.pass ? '✅ PASS' : '❌ FAIL';
            const color = test.pass ? 'green' : 'red';
            html += `<div style="color: ${color}; margin: 10px 0;">
                <strong>${status}</strong> - ${test.name}
                ${test.error ? `<br>&nbsp;&nbsp;&nbsp;Error: ${test.error}` : ''}
                ${test.result && !test.error ? `<br>&nbsp;&nbsp;&nbsp;Result: ${JSON.stringify(test.result)}` : ''}
            </div>`;

            if (test.pass) passed++;
            else failed++;
        });

        html += `<hr><h3>Summary: ${passed} passed, ${failed} failed</h3>`;
        results.innerHTML = html;

        console.log('Module tests completed:', { passed, failed, tests });
    </script>
</body>
</html>