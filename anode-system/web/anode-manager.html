<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Anode Management System</title>
    <link rel="stylesheet" href="anode-manager.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>‚öì Anode Management System</h1>
            <nav>
                <button class="nav-btn active" data-view="catalog">Catalog</button>
                <button class="nav-btn" data-view="inventory">Inventory</button>
                <button class="nav-btn" data-view="orders">Orders</button>
                <button class="nav-btn" data-view="sync">Sync</button>
                <button class="nav-btn" data-view="reports">Reports</button>
            </nav>
        </header>

        <!-- Catalog View -->
        <section id="catalog-view" class="view active">
            <div class="view-header">
                <h2>Boatzincs Catalog</h2>
                <div class="controls">
                    <input type="text" id="catalog-search" placeholder="Search anodes..." class="search-input">
                    <select id="material-filter" class="filter-select">
                        <option value="">All Materials</option>
                        <option value="zinc">Zinc</option>
                        <option value="aluminum">Aluminum</option>
                        <option value="magnesium">Magnesium</option>
                    </select>
                    <select id="category-filter" class="filter-select">
                        <option value="">All Categories</option>
                        <option value="shaft">Shaft</option>
                        <option value="hull">Hull</option>
                        <option value="engine">Engine</option>
                        <option value="propeller">Propeller</option>
                        <option value="rudder">Rudder/Trim Tab</option>
                        <option value="other">Other</option>
                    </select>
                    <button id="refresh-catalog" class="btn btn-secondary">‚Üª Refresh</button>
                </div>
            </div>
            <div class="stats-bar">
                <span>Total Products: <strong id="total-products">0</strong></span>
                <span>In Stock: <strong id="in-stock">0</strong></span>
                <span>On Sale: <strong id="on-sale">0</strong></span>
                <span>Last Sync: <strong id="last-sync">Never</strong></span>
            </div>
            <div id="catalog-grid" class="catalog-grid">
                <!-- Products will be loaded here -->
            </div>
            <div id="catalog-pagination" class="pagination"></div>
        </section>

        <!-- Inventory View -->
        <section id="inventory-view" class="view">
            <div class="view-header">
                <h2>Inventory Management</h2>
                <div class="controls">
                    <button id="add-inventory" class="btn btn-primary">+ Add Stock</button>
                    <button id="inventory-count" class="btn btn-secondary">üìä Count Inventory</button>
                    <button id="reorder-report" class="btn btn-warning">‚ö†Ô∏è Reorder Report</button>
                </div>
            </div>
            <div class="inventory-filters">
                <label>
                    <input type="checkbox" id="show-low-stock"> Show Low Stock Only
                </label>
                <label>
                    <input type="checkbox" id="show-out-of-stock"> Show Out of Stock
                </label>
            </div>
            <table id="inventory-table" class="data-table">
                <thead>
                    <tr>
                        <th>SKU</th>
                        <th>Product Name</th>
                        <th>On Hand</th>
                        <th>Allocated</th>
                        <th>Available</th>
                        <th>Reorder Point</th>
                        <th>Location</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Inventory rows will be loaded here -->
                </tbody>
            </table>
        </section>

        <!-- Orders View -->
        <section id="orders-view" class="view">
            <div class="view-header">
                <h2>Order Management</h2>
                <div class="controls">
                    <button id="create-order" class="btn btn-primary">+ Create Order</button>
                    <button id="auto-reorder" class="btn btn-secondary">üîÑ Auto-Reorder</button>
                    <select id="order-status-filter" class="filter-select">
                        <option value="">All Statuses</option>
                        <option value="draft">Draft</option>
                        <option value="submitted">Submitted</option>
                        <option value="confirmed">Confirmed</option>
                        <option value="shipped">Shipped</option>
                        <option value="delivered">Delivered</option>
                    </select>
                </div>
            </div>
            <table id="orders-table" class="data-table">
                <thead>
                    <tr>
                        <th>Order #</th>
                        <th>Date</th>
                        <th>Type</th>
                        <th>Status</th>
                        <th>Items</th>
                        <th>Total</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Orders will be loaded here -->
                </tbody>
            </table>
        </section>

        <!-- Sync View -->
        <section id="sync-view" class="view">
            <div class="view-header">
                <h2>Data Synchronization</h2>
            </div>
            <div class="sync-controls">
                <div class="sync-card">
                    <h3>üîÑ Full Catalog Sync</h3>
                    <p>Scrape entire Boatzincs catalog (takes 30-60 minutes)</p>
                    <button id="sync-full" class="btn btn-primary">Start Full Sync</button>
                    <div class="last-run">Last run: <span id="last-full-sync">Never</span></div>
                </div>
                <div class="sync-card">
                    <h3>üí∞ Price Update</h3>
                    <p>Quick price check for existing products (takes 5-10 minutes)</p>
                    <button id="sync-prices" class="btn btn-primary">Update Prices</button>
                    <div class="last-run">Last run: <span id="last-price-sync">Never</span></div>
                </div>
                <div class="sync-card">
                    <h3>üì¶ Stock Check</h3>
                    <p>Check stock status for all products</p>
                    <button id="sync-stock" class="btn btn-primary">Check Stock</button>
                    <div class="last-run">Last run: <span id="last-stock-sync">Never</span></div>
                </div>
            </div>
            <div class="sync-logs">
                <h3>Recent Sync History</h3>
                <table id="sync-logs-table" class="data-table">
                    <thead>
                        <tr>
                            <th>Date/Time</th>
                            <th>Type</th>
                            <th>Status</th>
                            <th>Processed</th>
                            <th>Added</th>
                            <th>Updated</th>
                            <th>Failed</th>
                            <th>Duration</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Sync logs will be loaded here -->
                    </tbody>
                </table>
            </div>
            <div id="sync-progress" class="sync-progress hidden">
                <h3>Sync in Progress...</h3>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 0%"></div>
                </div>
                <div class="progress-text">Starting...</div>
            </div>
        </section>

        <!-- Reports View -->
        <section id="reports-view" class="view">
            <div class="view-header">
                <h2>Reports & Analytics</h2>
            </div>
            <div class="reports-grid">
                <div class="report-card">
                    <h3>üìà Price Changes</h3>
                    <p>Products with recent price changes</p>
                    <button class="btn btn-secondary" onclick="anodeManager.loadPriceChanges()">View Report</button>
                </div>
                <div class="report-card">
                    <h3>üìâ Low Stock Alert</h3>
                    <p>Items below reorder point</p>
                    <button class="btn btn-warning" onclick="anodeManager.loadLowStock()">View Report</button>
                </div>
                <div class="report-card">
                    <h3>üíµ Order History</h3>
                    <p>Historical ordering data</p>
                    <button class="btn btn-secondary" onclick="anodeManager.loadOrderHistory()">View Report</button>
                </div>
                <div class="report-card">
                    <h3>üìä Inventory Value</h3>
                    <p>Total inventory valuation</p>
                    <button class="btn btn-secondary" onclick="anodeManager.loadInventoryValue()">View Report</button>
                </div>
            </div>
            <div id="report-content" class="report-content">
                <!-- Report content will be loaded here -->
            </div>
        </section>

        <!-- Modals -->
        <div id="product-modal" class="modal">
            <div class="modal-content">
                <span class="close">&times;</span>
                <h2 id="modal-product-name"></h2>
                <div class="modal-body">
                    <img id="modal-product-image" src="" alt="Product Image">
                    <div class="product-details">
                        <p><strong>SKU:</strong> <span id="modal-sku"></span></p>
                        <p><strong>Boatzincs ID:</strong> <span id="modal-boatzincs-id"></span></p>
                        <p><strong>Category:</strong> <span id="modal-category"></span></p>
                        <p><strong>Material:</strong> <span id="modal-material"></span></p>
                        <p><strong>List Price:</strong> $<span id="modal-list-price"></span></p>
                        <p><strong>Sale Price:</strong> $<span id="modal-sale-price"></span></p>
                        <p><strong>Stock Status:</strong> <span id="modal-stock-status"></span></p>
                        <p><strong>Description:</strong> <span id="modal-description"></span></p>
                        <p><strong>Last Updated:</strong> <span id="modal-last-updated"></span></p>
                    </div>
                    <div class="modal-actions">
                        <button class="btn btn-primary" onclick="anodeManager.addToInventory()">Add to Inventory</button>
                        <button class="btn btn-secondary" onclick="anodeManager.viewOnBoatzincs()">View on Boatzincs</button>
                        <button class="btn btn-secondary" onclick="anodeManager.updatePrice()">Update Price</button>
                    </div>
                </div>
            </div>
        </div>

        <div id="order-modal" class="modal">
            <div class="modal-content">
                <span class="close">&times;</span>
                <h2>Create Order</h2>
                <div class="modal-body">
                    <form id="order-form">
                        <div class="form-group">
                            <label>Order Type:</label>
                            <select id="order-type">
                                <option value="manual">Manual</option>
                                <option value="reorder">Reorder</option>
                                <option value="emergency">Emergency</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Items:</label>
                            <div id="order-items-list">
                                <!-- Order items will be added here -->
                            </div>
                            <button type="button" class="btn btn-secondary" onclick="anodeManager.addOrderItem()">+ Add Item</button>
                        </div>
                        <div class="form-group">
                            <label>Notes:</label>
                            <textarea id="order-notes" rows="3"></textarea>
                        </div>
                        <div class="form-actions">
                            <button type="submit" class="btn btn-primary">Create Order</button>
                            <button type="button" class="btn btn-secondary" onclick="anodeManager.closeModal()">Cancel</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="anode-manager.js"></script>
</body>
</html>